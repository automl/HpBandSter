

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Advanced examples &mdash; hpbandster  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Examples - How to use HpBandSter" href="auto_examples/index.html" />
    <link rel="prev" title="Quickstart Guide" href="quickstart.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> hpbandster
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Advanced examples</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="auto_examples/index.html">Examples - How to use HpBandSter</a></li>
<li class="toctree-l1"><a class="reference internal" href="best_practices.html">Best Practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="optimizers.html">Optimizers</a></li>
<li class="toctree-l1"><a class="reference internal" href="core_components.html">The core components in more detail</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">hpbandster</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Advanced examples</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/advanced_examples.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="advanced-examples">
<h1>Advanced examples<a class="headerlink" href="#advanced-examples" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#optimizing-a-small-convolutional-neural-network-on-mnist" id="id3">Optimizing a small Convolutional Neural Network on MNIST</a><ul>
<li><a class="reference internal" href="#a-more-realistic-search-space" id="id4">1) A more realistic Search Space</a></li>
<li><a class="reference internal" href="#live-logging" id="id5">2) Live logging</a></li>
<li><a class="reference internal" href="#visualization" id="id6">3) Visualization</a></li>
</ul>
</li>
<li><a class="reference internal" href="#continuing-a-run-or-warmstarting-the-optimization" id="id7">Continuing a Run or Warmstarting the Optimization</a></li>
</ul>
</div>
<div class="section" id="optimizing-a-small-convolutional-neural-network-on-mnist">
<span id="rd-example"></span><h2><a class="toc-backref" href="#id3">Optimizing a small Convolutional Neural Network on MNIST</a><a class="headerlink" href="#optimizing-a-small-convolutional-neural-network-on-mnist" title="Permalink to this headline">¶</a></h2>
<p>In this example we will cover the functionalities:</p>
<div class="line-block">
<div class="line"><a class="reference internal" href="#complicated-configspace"><span class="std std-ref">1) A more realistic Search Space</span></a></div>
<div class="line"><a class="reference internal" href="#live-logging"><span class="std std-ref">2) Live logging</span></a></div>
<div class="line"><a class="reference internal" href="#visualization"><span class="std std-ref">3) Visualization</span></a></div>
</div>
<p>The first two parts are covered in <a class="reference internal" href="auto_examples/example_5_mnist.html"><span class="doc">example 5</span></a> while the visualization is presented in <a class="reference internal" href="auto_examples/plot_example_6_analysis.html"><span class="doc">example 6</span></a> and  <a class="reference internal" href="auto_examples/plot_example_7_interactive_plot.html"><span class="doc">example 7</span></a></p>
<div class="section" id="a-more-realistic-search-space">
<span id="complicated-configspace"></span><h3><a class="toc-backref" href="#id4">1) A more realistic Search Space</a><a class="headerlink" href="#a-more-realistic-search-space" title="Permalink to this headline">¶</a></h3>
<p>So far, the search space in the quickstart examples consisted of a single continuous variables.
The interesting problems have, of course, more difficult spaces to search through.
Challenges include</p>
<ol class="loweralpha simple">
<li>higher number of dimensions</li>
<li>not only continuous parameters, but also integer values, categorical choices</li>
<li>dependencies/conditionalities between parameters</li>
</ol>
<p>The worker for <a class="reference internal" href="auto_examples/example_5_mnist.html"><span class="doc">the MNIST example</span></a> has a fairly complex search space that covers the challenges above.
Please checkout <a class="reference internal" href="auto_examples/example_5_keras_worker.html"><span class="doc">the Keras</span></a> or  <a class="reference internal" href="auto_examples/example_5_pytorch_worker.html"><span class="doc">the PyTorch</span></a> to see how the search space and how it is encoded.</p>
</div>
<div class="section" id="live-logging">
<span id="id1"></span><h3><a class="toc-backref" href="#id5">2) Live logging</a><a class="headerlink" href="#live-logging" title="Permalink to this headline">¶</a></h3>
<p>So far, the results of a run were only available after it finished.
For very long and expensive runs, one might want to check the progress while the optimization is still in progress.
To that end, HpBandSter includes a functionality that we call <strong>live logging</strong>.
The idea is simply to write enough information to disk such that intermediate results can be analysed the same way as completed runs.
The storage is implemented by the <a class="reference internal" href="core/result.html#hpbandster.core.result.json_result_logger" title="hpbandster.core.result.json_result_logger"><code class="xref py py-class docutils literal notranslate"><span class="pre">result</span> <span class="pre">logger</span></code></a> which stores two JSON files in a specified directory.
Loading that information is implemented in <a class="reference internal" href="core/result.html#hpbandster.core.result.logged_results_to_HBS_result" title="hpbandster.core.result.logged_results_to_HBS_result"><code class="xref py py-func docutils literal notranslate"><span class="pre">this</span> <span class="pre">function</span></code></a></p>
<p>To store the information simply create a <a class="reference internal" href="core/result.html#hpbandster.core.result.json_result_logger" title="hpbandster.core.result.json_result_logger"><code class="xref py py-class docutils literal notranslate"><span class="pre">result</span> <span class="pre">logger</span></code></a> and pass it to an optimizer.
The relevant lines from the <a class="reference internal" href="auto_examples/example_5_mnist.html"><span class="doc">example</span></a> are</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">hpbandster.core.result</span> <span class="k">as</span> <span class="nn">hpres</span>
<span class="n">result_logger</span> <span class="o">=</span> <span class="n">hpres</span><span class="o">.</span><span class="n">json_result_logger</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">shared_directory</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">bohb</span> <span class="o">=</span> <span class="n">BOHB</span><span class="p">(</span>  <span class="n">configspace</span> <span class="o">=</span> <span class="n">worker</span><span class="o">.</span><span class="n">get_configspace</span><span class="p">(),</span>
			  <span class="n">run_id</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">run_id</span><span class="p">,</span>
			  <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span>
			  <span class="n">nameserver</span><span class="o">=</span><span class="n">ns_host</span><span class="p">,</span>
			  <span class="n">nameserver_port</span><span class="o">=</span><span class="n">ns_port</span><span class="p">,</span>
			  <span class="n">result_logger</span><span class="o">=</span><span class="n">result_logger</span><span class="p">,</span>
			  <span class="n">min_budget</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">min_budget</span><span class="p">,</span> <span class="n">max_budget</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">max_budget</span><span class="p">,</span> 
		   <span class="p">)</span>
</pre></div>
</div>
<p>Please check out <a class="reference internal" href="auto_examples/plot_example_6_analysis.html"><span class="doc">example</span></a> to see how to load these results.</p>
</div>
<div class="section" id="visualization">
<span id="id2"></span><h3><a class="toc-backref" href="#id6">3) Visualization</a><a class="headerlink" href="#visualization" title="Permalink to this headline">¶</a></h3>
<p>HpBandster contains a few tools to visualize the results of an optimization run.
An example for the static plots can be found in <a class="reference internal" href="auto_examples/plot_example_6_analysis.html"><span class="doc">example 6</span></a>.
The presented quantities allow one to see how many configurations were evaluated on which budgets, how many concurrent runs were done during the optimization, and how the losses correlated across budgets.</p>
<p>There is also a small interactive plot tool shown in <a class="reference internal" href="auto_examples/plot_example_7_interactive_plot.html"><span class="doc">example 7</span></a>.
It allows to better explore the performance of the runs by plotting various iterations and allowing to show more information on selected configurations.
It is not the most elaborate tool, but maybe it can help to find patterns in the results.</p>
</div>
</div>
<div class="section" id="continuing-a-run-or-warmstarting-the-optimization">
<span id="warmstarting"></span><h2><a class="toc-backref" href="#id7">Continuing a Run or Warmstarting the Optimization</a><a class="headerlink" href="#continuing-a-run-or-warmstarting-the-optimization" title="Permalink to this headline">¶</a></h2>
<p>Under certain circumstances, one might want to continue a run, or reuse old evaluations for a slightly modified objective.
Those include, but are not limited to</p>
<ul class="simple">
<li>The run ended unexpectedly due to some hardware problems (computer crashed).</li>
<li>The analysis reveals that the optimization was still improving meaning the run was to short.</li>
<li>The maximum budget used in the run turned out to be insufficient to achieve the desired performance.</li>
<li>The finished run might have been an preliminary run on only a subset of the data to speed up the experiment. The obtained results are still good proxies for the full dataset.</li>
</ul>
<p>In <a class="reference internal" href="auto_examples/example_8_mnist_continued.html"><span class="doc">example 8</span></a>, we show how one loads the result of an <cite>old run</cite> and initialize the model for a new run.
Specifically, we optimize the same CNN architecture on MNIST, but train on more data points.
We also increased the minimum budget, as we do not expect anymore gains from evaluations after one epoch.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">While some specific details of the problem can change, it is important to realize that this only works if the search space is identical, and the old objective is still a very good approximation for the new one!
Continuing with the same worker, settings, and budgets using this functionality will not recover runs that where pending when the JSON files where written.
Also, the iterations start counting at zero again, i.e. it might use different budgets as the next iteration of the previous run would have used.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="auto_examples/index.html" class="btn btn-neutral float-right" title="Examples - How to use HpBandSter" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="quickstart.html" class="btn btn-neutral" title="Quickstart Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Stefan Falkner.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>